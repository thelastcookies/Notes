# ğŸ³ Docker

![docker-logo.jpg](images/docker__banner.png)

## ä»€ä¹ˆæ˜¯ Dockerï¼Ÿ

Docker æ˜¯ä¸€ç§ç”¨äºå¼€å‘ï¼ˆbuildï¼‰ã€è¿è¡Œï¼ˆrunï¼‰å’Œäº¤ä»˜ï¼ˆdeliverï¼‰åº”ç”¨ç¨‹åºçš„å¼€æºå¹³å°ï¼Œå®ƒé€šè¿‡å®¹å™¨åŒ–æŠ€æœ¯æ¥å®ç°è½»é‡çº§çš„åº”ç”¨ç¨‹åºéƒ¨ç½²ã€‚

## Why Dockerï¼Ÿ

### ç¯å¢ƒé…ç½®çš„éš¾é¢˜

è½¯ä»¶å¼€å‘ä¼šé‡åˆ°æœ€å¤§çš„éº»çƒ¦ä¹‹ä¸€ï¼Œå°±æ˜¯ç¯å¢ƒé…ç½®ã€‚
ç”¨æˆ·è®¡ç®—æœºçš„ç¯å¢ƒå„å¼‚ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿçš„è®¾ç½®ï¼Œå„ç§åº“å’Œç»„ä»¶çš„å®‰è£…å’Œç‰ˆæœ¬æƒ…å†µä¹Ÿä¸ç›¸åŒï¼Œå¼€å‘è€…å¸¸å¸¸ä¼šé‡åˆ°"å®ƒåœ¨æˆ‘çš„æœºå™¨å¯ä»¥è¿è¡Œ"ï¼ˆIt
works
on my machineï¼‰çš„æƒ…å†µã€‚

### è™šæ‹Ÿæœº

è™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰å°±æ˜¯è½¯ä»¶è¿åŒç¯å¢ƒå®‰è£…çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚
å®ƒå¯ä»¥åœ¨ä¸€ç§æ“ä½œç³»ç»Ÿé‡Œé¢è¿è¡Œå¦ä¸€ç§æ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚åœ¨ Windows ç³»ç»Ÿé‡Œé¢è¿è¡Œ Linux ç³»ç»Ÿï¼Œåº”ç”¨ç¨‹åºå¯¹æ­¤æ¯«æ— æ„ŸçŸ¥ã€‚
è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºäº’ä¸å¹²æ¶‰äº’ä¸å½±å“ã€‚

ä½†æ˜¯ï¼Œè¿™ä¸ªæ–¹æ¡ˆæœ‰å‡ ä¸ªç¼ºç‚¹ï¼š

- èµ„æºå ç”¨å¤šã€‚è™šæ‹Ÿæœºä¼šç‹¬å ä¸€éƒ¨åˆ†å†…å­˜å’Œç¡¬ç›˜ç©ºé—´ã€‚åœ¨å®ƒè¿è¡Œçš„æ—¶å€™ï¼Œå…¶ä»–ç¨‹åºå°±æ— æ³•ä½¿ç”¨è¿™äº›èµ„æºã€‚å“ªæ€•è™šæ‹Ÿæœºé‡Œé¢çš„åº”ç”¨ç¨‹åºï¼ŒçœŸæ­£ä½¿ç”¨çš„å†…å­˜åªæœ‰
  1MBï¼Œè™šæ‹Ÿæœºä¾ç„¶éœ€è¦å‡ ç™¾ MB çš„å†…å­˜æ‰èƒ½è¿è¡Œã€‚
- å†—ä½™æ­¥éª¤å¤šã€‚è™šæ‹Ÿæœºæ˜¯å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œä¸€äº›ç³»ç»Ÿçº§åˆ«çš„æ“ä½œæ­¥éª¤ï¼Œå¾€å¾€æ— æ³•è·³è¿‡ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•ã€‚
- å¯åŠ¨æ…¢ã€‚å¯åŠ¨æ“ä½œç³»ç»Ÿéœ€è¦å¤šä¹…ï¼Œå¯åŠ¨è™šæ‹Ÿæœºå°±éœ€è¦å¤šä¹…ã€‚å¯èƒ½è¦ç­‰å‡ åˆ†é’Ÿï¼Œåº”ç”¨ç¨‹åºæ‰èƒ½çœŸæ­£è¿è¡Œã€‚

### Linux å®¹å™¨

ç”±äºè™šæ‹Ÿæœºå­˜åœ¨è¿™äº›ç¼ºç‚¹ï¼ŒLinux å‘å±•å‡ºäº†å¦ä¸€ç§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼šLinux å®¹å™¨ï¼ˆLinux Containersï¼Œç¼©å†™ä¸º LXCï¼‰ã€‚

Linux å®¹å™¨ä¸æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹è¿›ç¨‹è¿›è¡Œéš”ç¦»ï¼Œå¯¹äºå®¹å™¨é‡Œé¢çš„è¿›ç¨‹æ¥è¯´ï¼Œå…¶æ¥è§¦åˆ°éƒ½æ˜¯è™šæ‹Ÿèµ„æºï¼Œä»è€Œäº†æ¥å®ç°ä¸å®¿ä¸»æœºçš„éš”ç¦»ã€‚

ç”±äºå®¹å™¨æ˜¯è¿›ç¨‹çº§åˆ«çš„ï¼Œç›¸æ¯”è™šæ‹Ÿæœºæœ‰å¾ˆå¤šä¼˜åŠ¿ã€‚

- å¯åŠ¨å¿«ã€‚å®¹å™¨é‡Œé¢çš„åº”ç”¨ï¼Œåªæ˜¯ä½œä¸ºå®¿ä¸»æœºçš„ä¸€ä¸ªè¿›ç¨‹ã€‚æ‰€ä»¥ï¼Œå¯åŠ¨å®¹å™¨ç›¸å½“äºå¯åŠ¨æœ¬æœºçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯åŠ¨é€Ÿåº¦æœ‰å¾ˆå¤§æå‡ã€‚
- èµ„æºå ç”¨å°‘ã€‚å®¹å™¨åªå ç”¨éœ€è¦çš„èµ„æºï¼Œå¤šä¸ªå®¹å™¨å¯ä»¥å…±äº«èµ„æºã€‚
- ä½“ç§¯å°ã€‚å®¹å™¨åªè¦åŒ…å«ç”¨åˆ°çš„ç»„ä»¶å³å¯ï¼Œæ‰€ä»¥ç›¸è¾ƒäºè™šæ‹Ÿæœºæ–‡ä»¶è¦å°å¾ˆå¤šã€‚

æ€»ä¹‹ï¼Œå®¹å™¨ç±»ä¼¼è½»é‡çº§çš„è™šæ‹Ÿæœºï¼Œèƒ½å¤Ÿæä¾›è™šæ‹ŸåŒ–çš„ç¯å¢ƒï¼Œä½†æ˜¯æˆæœ¬å¼€é”€å¤§å¤§é™ä½ã€‚

### Docker

Docker æ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆï¼Œå±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚

æ€»ä½“æ¥è¯´ï¼ŒDocker æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **è½»é‡çº§å’Œå¿«é€Ÿå¯åŠ¨**ï¼šDocker å®¹å™¨å…·æœ‰ Linux å®¹å™¨çš„ä¼˜ç‚¹ï¼Œç›¸æ¯”è™šæ‹Ÿæœºæ›´åŠ è½»é‡çº§ï¼Œå®¹å™¨å¯åŠ¨å’Œåœæ­¢çš„é€Ÿåº¦éå¸¸å¿«ã€‚è¿™ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥å¿«é€Ÿè¿­ä»£å’Œéƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œæé«˜äº†å¼€å‘å’Œéƒ¨ç½²çš„æ•ˆç‡ã€‚

- **ç¯å¢ƒä¸€è‡´æ€§**ï¼šDocker å¯ä»¥å°†åº”ç”¨ç¨‹åºå’Œå…¶ä¾èµ–çš„è¿è¡Œæ—¶ç¯å¢ƒæ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œç¡®ä¿åœ¨ä¸åŒçš„ç¯å¢ƒä¸­å…·æœ‰ç›¸åŒçš„è¿è¡Œç»“æœï¼Œè§£å†³äº†â€œå®ƒåœ¨æˆ‘çš„æœºå™¨ä¸Šå¯ä»¥è¿è¡Œâ€çš„é—®é¢˜ã€‚

- **éš”ç¦»æ€§å’Œå®‰å…¨æ€§**ï¼šDocker ä½¿ç”¨ Linux å†…æ ¸çš„å‘½åç©ºé—´å’Œæ§åˆ¶ç»„æŠ€æœ¯æ¥å®ç°å®¹å™¨ä¹‹é—´çš„éš”ç¦»ï¼Œæ¯ä¸ªå®¹å™¨éƒ½æ‹¥æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå’Œè¿›ç¨‹ç©ºé—´ï¼Œä¿è¯äº†å®¹å™¨ä¹‹é—´çš„äº’ç›¸éš”ç¦»ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚

- **å¯ç§»æ¤æ€§**ï¼šDocker å®¹å™¨å¯ä»¥åœ¨ä»»ä½•æ”¯æŒ Docker çš„å¹³å°ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬å¼€å‘äººå‘˜çš„ç¬”è®°æœ¬ç”µè„‘ã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒç­‰ï¼Œæä¾›äº†å¾ˆé«˜çš„å¯ç§»æ¤æ€§ã€‚

- **èµ„æºåˆ©ç”¨ç‡é«˜**ï¼šDocker å®¹å™¨å…±äº«æ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œå‡å°‘äº†èµ„æºçš„æµªè´¹ï¼Œæé«˜äº†èµ„æºçš„åˆ©ç”¨ç‡ã€‚å¤šä¸ªå®¹å™¨å¯ä»¥è¿è¡Œåœ¨åŒä¸€å°ç‰©ç†æœºä¸Šï¼Œç¡¬ä»¶èµ„æºçš„æç¬‘åˆ©ç”¨ã€‚

- **ä¾¿äºæ‰©å±•å’Œè‡ªåŠ¨åŒ–**ï¼šDocker æä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œ APIï¼Œå¯ä»¥è½»æ¾åœ°è¿›è¡Œæ‰©å±•å’Œè‡ªåŠ¨åŒ–ï¼Œæ¯”å¦‚ Docker Composeã€Docker
  Swarmã€Kubernetes ç­‰ï¼Œå¸®åŠ©å¼€å‘å›¢é˜Ÿæ„å»ºå’Œç®¡ç†å¤§è§„æ¨¡çš„å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚

## åŸºæœ¬æ¦‚å¿µ

### é•œåƒï¼ˆImageï¼‰

Docker Image æ˜¯ Docker ä¸­çš„ä¸€ä¸ªå…³é”®æ¦‚å¿µï¼Œç”¨äºæ‰“åŒ…åº”ç”¨ç¨‹åºã€è¿è¡Œæ—¶ç¯å¢ƒå’Œå…¶ä»–ä¾èµ–é¡¹çš„æ–‡ä»¶ç³»ç»Ÿã€‚

Image æ˜¯å®¹å™¨ï¼ˆContainerï¼‰çš„åŸºç¡€ï¼ŒåŒ…å«äº†ç”¨äºåˆ›å»ºå®¹å™¨çš„æ‰€æœ‰æ–‡ä»¶å’Œé…ç½®ä¿¡æ¯ï¼Œå¯ä»¥è¢«è§†ä¸ºå®¹å™¨çš„æ¨¡æ¿æˆ–è“å›¾ã€‚åŒä¸€ä¸ª Image
æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚

å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ª Image æ–‡ä»¶å¾€å¾€é€šè¿‡ç»§æ‰¿å¦ä¸€ä¸ª Image æ–‡ä»¶ï¼ŒåŠ ä¸Šä¸€äº›å®šåˆ¶åŒ–è®¾ç½®è€Œç”Ÿæˆã€‚

### å®¹å™¨

Docker Container æ˜¯ Docker åº”ç”¨ç¨‹åºçš„è¿è¡Œå®ä¾‹ï¼Œç”± Docker Image ç”Ÿæˆã€‚

å®¹å™¨åŒ–æŠ€æœ¯é€šè¿‡å°†åº”ç”¨ç¨‹åºåŠå…¶æ‰€æœ‰ä¾èµ–é¡¹æ‰“åŒ…æˆä¸€ä¸ªæ ‡å‡†åŒ–çš„å®¹å™¨ï¼Œä»è€Œå®ç°äº†è½¯ä»¶åœ¨ä¸åŒç¯å¢ƒä¸­çš„å¿«é€Ÿéƒ¨ç½²ã€å¯ç§»æ¤æ€§å’Œéš”ç¦»æ€§ã€‚

æ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç©ºé—´ã€ç½‘ç»œç©ºé—´å’Œç”¨æˆ·ç©ºé—´ï¼Œä½¿å¾—å®¹å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚

### æ•°æ®å·

Docker Volumes æ˜¯ç”¨äºåœ¨ Docker å®¹å™¨å’Œå®¿ä¸»æœºä¹‹é—´å…±äº«æ•°æ®çš„ä¸€ç§æœºåˆ¶ã€‚

ç”±äºå®¹å™¨åˆ›å»ºåäº§ç”Ÿçš„æ•°æ®æ˜¯æ˜“å¤±æ€§çš„ï¼Œåœ¨å®¹å™¨åœæ­¢åä¼šå…¨éƒ¨ä¸¢å¤±ï¼Œå› æ­¤å¼•å…¥ Volumes æ¥å°†å®¹å™¨çš„æ•°æ®æŒä¹…åŒ–ã€‚Volumes
å…è®¸å°†å®¿ä¸»æœºä¸Šçš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œä½¿å¾—å®¹å™¨ä¸­çš„æ•°æ®èƒ½å¤ŸæŒä¹…åŒ–ã€‚

å…è®¸å¤šä¸ªå®¹å™¨å…±äº«åŒä¸€ä¸ªæ•°æ®å·ï¼Œå¹¶ä¸”æ•°æ®å·ä¸­çš„æ•°æ®èƒ½å¤Ÿåœ¨é‡æ–°åˆ›å»ºæˆ–è€…åˆ é™¤å®¹å™¨åä»ä¿æŒä¸å˜ã€‚
æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨åˆ›å»ºæ—¶åŠ¨æ€åˆ›å»ºå’ŒæŒ‚è½½ï¼Œä¹Ÿå¯ä»¥äº‹å…ˆåˆ›å»ºå¹¶åœ¨å®¹å™¨è¿è¡Œæ—¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚

Docker æ”¯æŒä¸åŒçš„æ•°æ®å·é©±åŠ¨ç¨‹åºï¼Œç”¨äºå°†æ•°æ®å·è¿æ¥åˆ°ä¸åŒçš„å­˜å‚¨åç«¯ï¼Œå¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå­˜å‚¨ã€äº‘å­˜å‚¨ç­‰ã€‚

### Dockerfile

Dockerfile æ˜¯ç”¨äºå®šä¹‰ Docker Image æ„å»ºè¿‡ç¨‹çš„æ–‡æœ¬æ–‡ä»¶ã€‚

å¯ä»¥é€šè¿‡ Dockerfileï¼ŒæŒ‡å®šåº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€ä¾èµ–å…³ç³»å’Œæ“ä½œæ­¥éª¤ï¼Œä»è€Œåˆ›å»ºå®šåˆ¶åŒ–çš„ Docker é•œåƒã€‚

Dockerfile çš„ä¸»è¦å†…å®¹æœ‰ï¼š

#### åŸºç¡€é•œåƒï¼ˆBase Imageï¼‰

Dockerfile é€šå¸¸ä»¥æŒ‡å®šåŸºç¡€é•œåƒå¼€å§‹æ„å»ºè¿‡ç¨‹ã€‚åŸºç¡€é•œåƒæ˜¯æ„å»ºè¿‡ç¨‹çš„èµ·ç‚¹ï¼Œå®ƒåŒ…å«äº†æ“ä½œç³»ç»Ÿå’Œä¸€äº›åŸºæœ¬çš„è½¯ä»¶åŒ…ã€‚æ‚¨å¯ä»¥é€‰æ‹©ä»ç°æœ‰çš„å…¬å¼€é•œåƒå¼€å§‹æ„å»ºï¼Œæˆ–è€…åˆ›å»ºè‡ªå·±çš„åŸºç¡€é•œåƒã€‚

#### æŒ‡ä»¤ï¼ˆInstructionsï¼‰

Dockerfile
åŒ…å«ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œæ¯ä¸ªæŒ‡ä»¤éƒ½ä¼šæ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„æ“ä½œã€‚å¸¸è§çš„æŒ‡ä»¤åŒ…æ‹¬FROMï¼ˆæŒ‡å®šåŸºç¡€é•œåƒï¼‰ã€RUNï¼ˆåœ¨é•œåƒä¸­æ‰§è¡Œå‘½ä»¤ï¼‰ã€COPYï¼ˆå¤åˆ¶æ–‡ä»¶åˆ°é•œåƒä¸­ï¼‰ã€ADDï¼ˆå¤åˆ¶å¹¶è§£å‹æ–‡ä»¶åˆ°é•œåƒä¸­ï¼‰ã€CMDï¼ˆè®¾ç½®å®¹å™¨å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ï¼‰ç­‰ã€‚

#### å·¥ä½œç›®å½•ï¼ˆWorking Directoryï¼‰

ä½¿ç”¨WORKDIRæŒ‡ä»¤å¯ä»¥è®¾ç½®å®¹å™¨å†…çš„å·¥ä½œç›®å½•ã€‚åœ¨å·¥ä½œç›®å½•ä¸­æ‰§è¡Œçš„åç»­æŒ‡ä»¤å°†åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œã€‚

#### å¤åˆ¶æ–‡ä»¶ï¼ˆCopying Filesï¼‰

ä½¿ç”¨COPYå’ŒADDæŒ‡ä»¤å¯ä»¥å°†æœ¬åœ°æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­ã€‚è¿™å¯¹äºå°†åº”ç”¨ç¨‹åºä»£ç ã€é…ç½®æ–‡ä»¶ç­‰æ·»åŠ åˆ°é•œåƒä¸­éå¸¸æœ‰ç”¨ã€‚

#### æ„å»ºç¯å¢ƒï¼ˆBuild Environmentï¼‰

é€šè¿‡ARGæŒ‡ä»¤å¯ä»¥å®šä¹‰æ„å»ºæ—¶çš„ç¯å¢ƒå˜é‡ã€‚è¿™äº›å˜é‡å¯ä»¥åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¼ é€’ç»™RUNæŒ‡ä»¤ï¼Œå¹¶åœ¨æ„å»ºæ—¶çµæ´»åœ°è¿›è¡Œé…ç½®ã€‚

#### æš´éœ²ç«¯å£ï¼ˆExpose Portsï¼‰

ä½¿ç”¨EXPOSEæŒ‡ä»¤å¯ä»¥æŒ‡å®šå®¹å™¨è¿è¡Œæ—¶è¦æš´éœ²çš„ç«¯å£ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—å®¹å™¨ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿæ¥æ”¶å¤–éƒ¨çš„ç½‘ç»œè¯·æ±‚ã€‚

#### å…¥å£ç‚¹ï¼ˆEntry Pointï¼‰

ä½¿ç”¨ENTRYPOINTæŒ‡ä»¤å¯ä»¥è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„é»˜è®¤å‘½ä»¤ã€‚ä¸CMDæŒ‡ä»¤ä¸åŒï¼ŒENTRYPOINTæŒ‡ä»¤è®¾ç½®çš„å‘½ä»¤ä¸ä¼šè¢«docker
runå‘½ä»¤ä¸­ä¼ é€’çš„å‚æ•°è¦†ç›–ã€‚

é€šè¿‡ç¼–å†™ä¸€ä¸ªDockerfileï¼Œæ‚¨å¯ä»¥å°†åº”ç”¨ç¨‹åºçš„æ„å»ºè¿‡ç¨‹æè¿°ä¸ºä¸€ç³»åˆ—æ¸…æ™°çš„æ­¥éª¤ï¼Œä»è€Œå®ç°åº”ç”¨ç¨‹åºåœ¨ä¸åŒç¯å¢ƒä¸­çš„ä¸€è‡´éƒ¨ç½²å’Œè¿è¡Œã€‚å®ŒæˆDockerfileåï¼Œå¯ä»¥ä½¿ç”¨docker
buildå‘½ä»¤å°†å…¶æ„å»ºä¸ºDockeré•œåƒï¼Œç„¶åé€šè¿‡docker runå‘½ä»¤å¯åŠ¨å®¹å™¨å¹¶è¿è¡Œåº”ç”¨ç¨‹åºã€‚

### ä»“åº“

## å®‰è£…é…ç½®

ä¸‹é¢æä¾›ä¸€äº›å®˜æ–¹çš„å®‰è£…æ–‡æ¡£ï¼Œå¹¶è¯¦ç»†è¯´æ˜åœ¨ `Linuxï¼ˆDebianï¼‰` ç¯å¢ƒä¸‹çš„å®‰è£…è¿‡ç¨‹ã€‚

- [Install On Mac](https://docs.docker.com/desktop/install/mac-install/)
- [Install On Linux](https://docs.docker.com/engine/install/)
- [Install On Windows](https://docs.docker.com/desktop/install/windows-install/)

### Linuxï¼ˆDebianï¼‰ä¸‹çš„å®‰è£…

#### æ“ä½œç³»ç»Ÿè¦æ±‚

å®‰è£… Docker å¼•æ“ï¼Œéœ€è¦ 64 ä½çš„ Debian ç¯å¢ƒï¼š

- Debian Bookworm 12ï¼ˆstableï¼‰
- Debian Bullseye 11ï¼ˆold-stableï¼‰

#### å¸è½½æ—§ç‰ˆæœ¬

åœ¨å®‰è£… Docker å¼•æ“ä¹‹å‰ï¼Œéœ€è¦å¸è½½ä»»ä½•å†²çªçš„è½¯ä»¶åŒ…ã€‚

éœ€è¦å¸è½½çš„éå®˜æ–¹è½¯ä»¶åŒ…åŒ…æ‹¬ï¼š

- docker.io
- docker-compose
- docker-doc
- podman-docker

è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å¸è½½æ‰€æœ‰å†²çªçš„è½¯ä»¶åŒ…ï¼š

```shell
for pkg in docker.io docker-doc docker-compose podman-docker containerd runc; do sudo apt-get remove $pkg; done
```

#### å®‰è£…æ–¹æ³•

æ ¹æ®éœ€æ±‚ï¼Œå¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼å®‰è£… Docker å¼•æ“ï¼š

- å®‰è£… Docker Desktop for Linuxï¼›
- ä½¿ç”¨ apt åº“è¿›è¡Œå®‰è£…ï¼›
- æ‰‹åŠ¨å®‰è£…å¹¶æ‰‹åŠ¨ç®¡ç†å‡çº§ï¼›
- ä½¿ç”¨ä¾¿æ·è„šæœ¬ï¼Œä»…å»ºè®®ç”¨äºæµ‹è¯•å’Œå¼€å‘ç¯å¢ƒã€‚

#### ä½¿ç”¨ apt è¿›è¡Œå®‰è£…

åœ¨æ–°ä¸»æœºä¸Šé¦–æ¬¡å®‰è£… Docker å¼•æ“ä¹‹å‰ï¼Œéœ€è¦è®¾ç½® Docker çš„ apt å­˜å‚¨åº“ã€‚ä¹‹åå°±å¯ä»¥ä½¿ç”¨ apt å®‰è£…å’Œæ›´æ–° Dockerã€‚

##### 1. è®¾ç½® Docker çš„ apt åº“

```shell
# æ·»åŠ  Docker å®˜æ–¹ GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# ä¸º apt æ·»åŠ ä»“åº“
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```

##### 2. å®‰è£… Docker

```shell
$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

##### 3. ç”¨ `hello-world` é•œåƒæ¥éªŒè¯å®‰è£…ç»“æœ

```shell
$ sudo docker run hello-world
```

è¿™æ¡æŒ‡ä»¤ä¼šä¸‹è½½ä¸€ä¸ªæµ‹è¯•é•œåƒå¹¶åœ¨å®¹å™¨ä¸­è¿è¡Œå®ƒã€‚å½“å®¹å™¨è¿è¡Œæ—¶ï¼Œå®ƒä¼šæ‰“å°ä¸€ä¸ªç¡®è®¤æ¶ˆæ¯ç„¶åé€€å‡ºã€‚

æ›´å¤šå¸®åŠ©è¯·å‚è€ƒ [Docker](https://www.docker.com) å®˜æ–¹æ–‡æ¡£ã€‚

## å¸¸ç”¨å‘½ä»¤

## æ„å»ºé•œåƒ

## è¿è¡Œå®¹å™¨

## Docker Compose

## Kubernetes

https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html

## å›½å†…é•œåƒæºï¼ˆDaoCloudï¼‰

å¯ä»¥å°†åŸä»“åº“çš„ url æ›¿æ¢ä¸º DaoCloud çš„ urlã€‚

```text
docker.io => docker.m.daocloud.io
gcr.io => gcr.m.daocloud.io
ghcr.io => ghcr.m.daocloud.io
k8s.gcr.io => k8s-gcr.m.daocloud.io
registry.k8s.io => k8s.m.daocloud.io
quay.io => quay.m.daocloud.io
```

## Docker - MySQL éƒ¨ç½²

### æ‹‰å–å®˜æ–¹é•œåƒ

æ‹‰å–æœ€æ–°ç‰ˆ MySQL é•œåƒï¼š

```shell
docker pull mysql 
```

æˆ–æ‹‰å–æŒ‡å®šç‰ˆæœ¬ï¼š

```shell
docker pull mysql:5.7
```

### æ£€æŸ¥æ˜¯å¦æ‹‰å–æˆåŠŸ

```
sudo docker images
```

### å»ºç«‹å®¹å™¨

```shell
sudo docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql
```

- â€“nameï¼šå®¹å™¨åï¼Œæ­¤å¤„å‘½åä¸º `mysql`
- -pï¼šç«¯å£æ˜ å°„ï¼Œæ˜ å°„ä¸»æœº`3306`ç«¯å£åˆ°å®¹å™¨çš„`3306`ç«¯å£
- -eï¼šé…ç½®ä¿¡æ¯ï¼Œé…ç½® `mysql` çš„ `root` ç”¨æˆ·çš„ç™»é™†å¯†ç 
- -dï¼šåå°è¿è¡Œå®¹å™¨ï¼Œä¿è¯åœ¨é€€å‡ºç»ˆç«¯åå®¹å™¨ç»§ç»­è¿è¡Œ

å¦‚æœè¦åœ¨å»ºç«‹å®¹å™¨æ—¶å»ºç«‹ç›®å½•æ˜ å°„ï¼Œåˆ™

```shell
sudo docker run --name mysql \
--restart=unless-stopped \
-p 3306:3306 \
-v /etc/docker/mysql/conf:/etc/mysql \
-v /etc/docker/mysql/logs:/var/log/mysql \
-v /etc/docker/mysql/data:/var/lib/mysql \
-e MYSQL_ROOT_PASSWORD=123456 \
-d mysql
```

- -vï¼šä¸»æœºå’Œå®¹å™¨çš„ç›®å½•æ˜ å°„å…³ç³»
- ":"ï¼šå‰ä¸ºä¸»æœºç›®å½•ï¼Œä¹‹åä¸ºå®¹å™¨ç›®å½•

### æ£€æŸ¥å®¹å™¨æ˜¯å¦æ­£ç¡®è¿è¡Œ

```shell
docker container ls
```

å¯ä»¥çœ‹åˆ°å®¹å™¨IDï¼Œå®¹å™¨çš„æºé•œåƒï¼Œå¯åŠ¨å‘½ä»¤ï¼Œåˆ›å»ºæ—¶é—´ï¼ŒçŠ¶æ€ï¼Œç«¯å£æ˜ å°„ä¿¡æ¯ï¼Œå®¹å™¨åå­—ã€‚

### è¿æ¥ MySQL

```shell
sudo docker exec -it mysql bash
mysql -uroot -p123456
```

### å¦‚æœæ— æ³•è®¿é—®åˆ° MySQL

å¦‚æœä½ çš„å®¹å™¨è¿è¡Œæ­£å¸¸ï¼Œä½†æ˜¯æ— æ³•è®¿é—®åˆ°MySQLï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ä¸ªå¯èƒ½çš„åŸå› ï¼š

#### æ²¡æœ‰è¿œç¨‹è®¿é—®æƒé™

```shell
mysql> grant all privileges on *.* to root@'%' identified by "password";
mysql> flush privileges;
```

#### é˜²ç«å¢™é˜»æ‹¦

```shell
$ systemctl status firewalld
$ firewall-cmd  --zone=public --add-port=3306/tcp -permanent
$ firewall-cmd  --reload
$ sudo systemctl stop firewalld
```
